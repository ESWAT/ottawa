(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n;d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],k=["January","February","March","April","May","June","July","August","September","October","November","December"],c=[31,28,31,30,31,30,31,31,30,31,30,31],j="https://www.googleapis.com/calendar/v3/calendars/infilexfil.com_ij0amp5h2lir3tlf4sqfpb2geo@group.calendar.google.com/events?key=AIzaSyCJq9lb_y7fnomgGFsDFBRzngucKZL-Ri8",a=function(a,e){return this.month=isNaN(a)||null==a?(new Date).getMonth():a,this.year=isNaN(e)||null==e?(new Date).getFullYear():e,React.renderComponent(l({monthLabel:k[this.month]}),document.getElementById("month-heading")),React.renderComponent(b({currentMonth:this.month,dayHeadings:d,monthLength:c[this.month],startOffset:new Date(this.year,this.month,1).getDay(),url:j,pollInterval:432e5}),document.getElementById("calendar"))},$(function(){var b;return b=new a}),m=React.DOM,l=React.createClass({render:function(){return m.span({"class":"month-heading"},""+this.props.monthLabel+" "+(new Date).getFullYear())}}),b=React.createClass({loadCalendarFeed:function(){return $.get(this.props.url,function(a){return this.isMounted()?this.setState({eventsList:a.items}):void 0}.bind(this))},getInitialState:function(){return{eventsList:[]}},componentDidMount:function(){return this.loadCalendarFeed(),setInterval(this.loadCalendarFeed,this.props.pollInterval)},render:function(){return m.table({id:"calendar",className:"calendar"},g({dayHeadings:this.props.dayHeadings}),f({currentMonth:this.props.currentMonth,monthLength:this.props.monthLength,startOffset:this.props.startOffset,eventsList:this.state.eventsList}))}}),g=React.createClass({render:function(){var a;return m.thead({className:"days-of-week"},m.tr(null,function(){var b,c,d,e;for(d=this.props.dayHeadings,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(m.th({className:"days-of-week--label"},""+a));return e}.call(this)))}}),f=React.createClass({getCurrentEvents:function(){var a,b,c,d,e,f;for(c=[],f=this.props.eventsList,d=0,e=f.length;e>d;d++)a=f[d],b=new Date(a.start.dateTime).getMonth(),b===this.props.currentMonth&&c.push(a);return c},render:function(){var a,b;return a=this.getCurrentEvents(),m.tbody({className:"day-grid"},m.tr({className:"day-grid"},m.td({className:"day-grid",colSpan:7},function(){var c,d,e;for(e=[],b=c=1,d=this.props.monthLength+this.props.startOffset;d>=c;b=c+=7)e.push(n({rowHeight:100/Math.ceil((this.props.monthLength+this.props.startOffset)/7)+"%",currentEvents:a,startOffset:8>b?this.props.startOffset:0,daysCounted:8>b?b:b-this.props.startOffset,monthLength:this.props.monthLength}));return e}.call(this))))}}),n=React.createClass({render:function(){var a,b,c,d,f,g,h;return h={height:this.props.rowHeight},m.div({className:"week-wrap",style:h},m.table({className:"week"},function(){var a,b,c;if(this.props.startOffset>0){for(c=[],f=a=1,b=this.props.startOffset;b>=1?b>=a:a>=b;f=b>=1?++a:--a)c.push(e({date:"",specialClass:" day--outside"}));return c}}.call(this),function(){var f,h,i,j,k,l,m;for(m=[],b=f=j=this.props.daysCounted,k=this.props.daysCounted+6-this.props.startOffset;k>=j?k>=f:f>=k;b=k>=j?++f:--f){for(d=[],l=this.props.currentEvents,h=0,i=l.length;i>h;h++)a=l[h],c=new Date(a.start.dateTime).getDate(),c===b&&d.push(a);g="",g+=b<=this.props.monthLength?"":" day--outside",g+=b===(new Date).getDate()?" day--today":"",m.push(e({date:b<=this.props.monthLength?b:"",eventsForDay:d,specialClass:g}))}return m}.call(this)))}}),e=React.createClass({render:function(){var a;return m.td({className:"day"+this.props.specialClass},m.h3({className:"day-label"},this.props.date),function(){var b,c,d,e;if(this.props.eventsForDay){for(d=this.props.eventsForDay,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(i({eventInfo:a,onClick:this.showEvent}));return e}}.call(this))}}),i=React.createClass({getInitialState:function(){return{handledClick:!1,showEventDetails:!1}},componentDidMount:function(){return window.addEventListener("click",this.hideEvent),console.log(this.refs.label.getDOMNode().offsetHeight)},showEvent:function(){return this.setState({handledClick:!0,showEventDetails:!0})},hideEvent:function(a){var b,c,d;return c=a.target.offsetParent.className,d=a.target.className,b="event-details",c!==b&&d!==b&&(this.state.showEventDetails&&this.state.handledClick!==!0&&this.setState({showEventDetails:!1}),this.state.handledClick)?this.setState({handledClick:!1}):void 0},render:function(){return m.div({className:"event"},m.h4({className:"event__label",ref:"label",onClick:this.showEvent},m.span({className:"event__time"},""+moment(this.props.eventInfo.start.dateTime).format("H:mm")+" "),m.span({className:"event__summary"},""+this.props.eventInfo.summary)),this.state.showEventDetails?h({eventInfo:this.props.eventInfo,titleHeight:this.refs.label.getDOMNode().height}):void 0)}}),h=React.createClass({getInitialState:function(){return{elOffset:"20px"}},componentDidMount:function(){var a,b,c;return c=document.body.getBoundingClientRect(),a=this.getDOMNode().getBoundingClientRect(),c.bottom<a.bottom?(b=Math.ceil(a.bottom-a.top),console.log("out of bounds by "+Math.ceil(c.bottom-a.bottom)),this.setState({elOffset:-b})):void 0},render:function(){return m.div({className:"event-details",style:{top:""+this.state.elOffset}},m.h2({className:"event-details__title"},""+this.props.eventInfo.summary),m.p({className:"event-details__date"},""+moment(this.props.eventInfo.start.dateTime).format("H:mm")+" - "+moment(this.props.eventInfo.end.dateTime).format("H:mm")),m.p({className:"event-details__description"},""+this.props.eventInfo.description))}})}).call(this);